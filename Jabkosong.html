<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jabatan Kosong | PUSLAT KODIKLATAU</title>
<style>
body {
  background-color: black;
  color: #00ff00;
  font-family: "Courier New", monospace;
  padding: 20px;
  font-size: 12px;
}
pre {
  white-space: pre-wrap;
  word-wrap: break-word;
}
.typing {
  border-right: 2px solid #00ff00;
  animation: blinkCursor 0.7s infinite;
}
@keyframes blinkCursor {
  50% { border-color: transparent; }
}
.blink-red {
  color: #ff0000;
  animation: blinkRed 0.45s infinite;
}
@keyframes blinkRed {
  0%, 100% { color: #ff0000; }
  50% { color: #330000; }
}
.yellow { color: #ffff00; }
</style>
</head>
<body>

<pre id="terminal" class="typing"></pre>

<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbyexzcrZz-eiXwvoYrhpqncUTvN8H1ri-yr3zmmhVcHa4nIFd7p--bfvZY4ZJb9zkqb/exec"; // GANTI dengan URL Web App kamu

const headerText = `
====================================
| FILE: PERSONEL PUSLAT KODIKLATAU |
| CLASSIFICATION: `;
const rahasiaWord = "RAHASIA";
const footerTop = `
====================================

[DAFTAR <span class='yellow'>JABATAN KOSONG</span>]
--------------------------------------------------------------------------------------------------------------------------------------------
NO   JABATAN KOSONG                     GOL.JAB   PANGKAT         KORPS
--------------------------------------------------------------------------------------------------------------------------------------------
`;
const footerBottom = `
--------------------------------------------------------------------------------------------------------------------------------------------
* Data diambil langsung dari Google Sheet.
* Diperbarui otomatis setiap kali Web App diakses.
--------------------------------------------------------------------------------------------------------------------------------------------
`;

const terminal = document.getElementById("terminal");
let i = 0, step = 0, rahasiaSpan;

function typeHeader() {
  if (i < headerText.length) {
    terminal.innerHTML += headerText.charAt(i);
    i++;
    setTimeout(typeHeader, 2);
  } else {
    i = 0;
    rahasiaSpan = document.createElement("span");
    rahasiaSpan.id = "rahasia";
    terminal.appendChild(rahasiaSpan);
    typeRahasia();
  }
}

function typeRahasia() {
  if (i < rahasiaWord.length) {
    rahasiaSpan.textContent += rahasiaWord.charAt(i);
    if (i === 0) rahasiaSpan.classList.add("blink-red");
    i++;
    setTimeout(typeRahasia, 2);
  } else {
    i = 0;
    typeData();
  }
}

async function typeData() {
  terminal.innerHTML += footerTop;

  try {
    const res = await fetch(WEB_APP_URL);
    const data = await res.json();
    let text = "";

    data.forEach(row => {
      const { no, jabatan, golongan, pangkat, korps } = row;
      text += `${String(no).padEnd(4)} ${jabatan.padEnd(35)} ${golongan.padEnd(15)} ${pangkat.padEnd(25)} ${korps}\n`;
    });

    let index = 0;
    function typeLine() {
      if (index < text.length) {
        terminal.innerHTML += text.charAt(index);
        index++;
        setTimeout(typeLine, 2);
      } else {
        terminal.innerHTML += footerBottom;
        terminal.classList.remove("typing");
      }
    }
    typeLine();
  } catch (e) {
    terminal.innerHTML += "\n[ERROR] Tidak dapat memuat data dari Google Sheet.";
    terminal.classList.remove("typing");
  }
}

typeHeader();
</script>

</body>
</html>
